<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Best IPTV Player</title>
    <link href="https://vjs.zencdn.net/7.20.3/video-js.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --bg-dark: #0f0f0f;
            --surface: #1e1e1e;
            --accent-blue: #3b82f6;
            --text-gray: #b3b3b3;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Arial', sans-serif; }
        body { background-color: var(--bg-dark); color: white; }

        /* --- Header & Logo Section --- */
        .logo-section {
            background: white;
            text-align: center;
            padding: 20px 0;
            position: relative;
        }
        .logo-img { height: 80px; } /* আপনার লোগোর সাইজ অনুযায়ী */
        
        /* --- Video Player Styling --- */
        .video-wrapper { width: 100%; background: #000; position: relative; }
        .video-js { width: 100%; aspect-ratio: 16/9; }
        
        /* ভিডিওর ওপর বড় প্লে বাটন কাস্টমাইজ */
        .vjs-big-play-button {
            background-color: rgba(0,0,0,0.5) !important;
            border: none !important;
            width: 80px !important; height: 80px !important;
            line-height: 80px !important; border-radius: 50% !important;
            top: 50% !important; left: 50% !important;
            transform: translate(-50%, -50%) !important;
        }

        /* --- Navigation Buttons (All, Categories, Favorites) --- */
        .nav-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            padding: 15px 10px;
            background: #121212;
        }
        .nav-btn {
            background: #2a2a2a;
            color: var(--text-gray);
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            display: flex; align-items: center; gap: 5px;
        }
        .nav-btn.active {
            background: var(--accent-blue);
            color: white;
        }

        /* --- Search Bar --- */
        .search-area {
            padding: 10px 15px;
            background: #121212;
        }
        .search-input {
            width: 100%;
            background: #262626;
            border: 1px solid #333;
            padding: 12px 15px;
            border-radius: 8px;
            color: white;
            outline: none;
        }

        /* --- 3-Column Channel List with Round Logos --- */
        .channel-list {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            padding: 15px;
        }
        .channel-item {
            text-align: center;
            cursor: pointer;
        }
        .circle-logo {
            width: 65px; height: 65px;
            background: #000;
            border-radius: 50%;
            margin: 0 auto 8px;
            overflow: hidden;
            border: 2px solid #333;
            display: flex; align-items: center; justify-content: center;
        }
        .circle-logo img { width: 100%; height: 100%; object-fit: cover; }
        .channel-name {
            font-size: 0.75rem;
            color: var(--text-gray);
            white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
        }
    </style>
</head>
<body>

    <div class="logo-section">
        <img src="https://i.ibb.co/vYm6zG0/best-iptv-logo.png" alt="Best IPTV" class="logo-img">
    </div>

    <div class="video-wrapper">
        <video id="iptv-video" class="video-js vjs-big-play-centered" controls preload="auto" data-setup='{}'>
            <p class="vjs-no-js">JavaScript is required to view this video.</p>
        </video>
    </div>

    <div class="nav-container">
        <button class="nav-btn"><i class="fas fa-th-large"></i> All</button>
        <button class="nav-btn"><i class="fas fa-list"></i> Categories</button>
        <button class="nav-btn active"><i class="fas fa-heart"></i> Favorites</button>
    </div>

    <div class="search-area">
        <input type="text" id="searchBox" class="search-input" placeholder="Search channels...">
    </div>

    <div class="channel-list" id="channelGrid">
        </div>

    <script src="https://vjs.zencdn.net/7.20.3/video.min.js"></script>
    <script>
        const player = videojs('iptv-video');
        const grid = document.getElementById('channelGrid');
        const searchInput = document.getElementById('searchBox');
        let channelsData = [];

        // প্লে করার ফাংশন
        function play(url) {
            player.src({ src: url, type: 'application/x-mpegURL' });
            player.play();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // M3U ফেচিং
        async function loadData() {
            const params = new URLSearchParams(window.location.search);
            const m3u = params.get('playlist');
            if(!m3u) return;

            try {
                const res = await fetch(m3u);
                const text = await res.text();
                channelsData = parse(text);
                render(channelsData);
            } catch (e) { console.error("Error loading M3U"); }
        }

        function parse(data) {
            const lines = data.split('\n');
            const result = [];
            let current = null;
            lines.forEach(line => {
                if (line.startsWith('#EXTINF:')) {
                    const name = line.split(',').pop();
                    const logo = line.match(/tvg-logo="([^"]*)"/)?.[1] || '';
                    current = { name, logo };
                } else if (line.trim() && !line.startsWith('#')) {
                    if (current) { result.push({...current, url: line.trim()}); current = null; }
                }
            });
            return result;
        }

        function render(list) {
            grid.innerHTML = list.length ? '' : '<p style="grid-column: span 3; text-align: center; color: gray; margin-top: 20px;">No channels found</p>';
            list.forEach(item => {
                const div = document.createElement('div');
                div.className = 'channel-item';
                div.innerHTML = `
                    <div class="circle-logo">
                        <img src="${item.logo}" onerror="this.src='https://cdn-icons-png.flaticon.com/512/716/716429.png'">
                    </div>
                    <div class="channel-name">${item.name}</div>
                `;
                div.onclick = () => play(item.url);
                grid.appendChild(div);
            });
        }

        searchInput.oninput = () => {
            const q = searchInput.value.toLowerCase();
            render(channelsData.filter(c => c.name.toLowerCase().includes(q)));
        };

        window.onload = loadData;
    </script>
</body>
</html>
