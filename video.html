<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Live TV Player</title>

<link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
body{
    margin:0;
    font-family: Arial, sans-serif;
    background:#0b0b0b;
    color:#fff;
}
header{
    padding:10px;
    background:#000;
    display:flex;
    align-items:center;
    gap:10px;
}
header h2{margin:0;font-size:18px;}

.player-wrap{
    position:relative;
}
#loader{
    position:absolute;
    inset:0;
    background:rgba(0,0,0,.6);
    display:flex;
    align-items:center;
    justify-content:center;
    z-index:5;
}
.spinner{
    width:40px;
    height:40px;
    border:4px solid #444;
    border-top:4px solid #0af;
    border-radius:50%;
    animation:spin 1s linear infinite;
}
@keyframes spin{100%{transform:rotate(360deg)}}

.actions{
    display:flex;
    justify-content:space-around;
    padding:10px;
    border-bottom:1px solid #222;
}
.actions div{
    text-align:center;
    cursor:pointer;
    font-size:14px;
}

.channel-list{
    padding:10px;
}
.channel{
    display:flex;
    align-items:center;
    gap:10px;
    background:#151515;
    padding:10px;
    margin-bottom:8px;
    border-radius:8px;
    cursor:pointer;
}
.channel img{
    width:40px;
    height:40px;
    object-fit:contain;
}
.channel i.logo-fallback{
    font-size:28px;
    color:#666;
}
.channel span{
    flex:1;
}
.star{
    font-size:18px;
    color:#555;
}
.star.active{
    color:#0af;
}
.hidden{display:none;}
</style>
</head>

<body>

<header>
    <i class="fa fa-arrow-left"></i>
    <h2>Live Stream</h2>
</header>

<div class="player-wrap">
    <div id="loader"><div class="spinner"></div></div>
    <video id="player" class="video-js vjs-default-skin" controls playsinline></video>
</div>

<div class="actions">
    <div onclick="showAll()"><i class="fa fa-list"></i><br>All</div>
    <div onclick="showFav()"><i class="fa fa-star"></i><br>My List</div>
</div>

<div class="channel-list" id="channelList"></div>

<script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>

<script>
const channels = [
 {id:1,name:"Akash Go",logo:"https://i.imgur.com/5x3JZQp.png",url:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"},
 {id:2,name:"BTV",logo:"",url:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"},
 {id:3,name:"BTV News",logo:"",url:"https://test-streams.mux.dev/x36xhzz/x36xhzz.m3u8"},
];

let favs = JSON.parse(localStorage.getItem("favs")) || [];

const player = videojs("player",{
    autoplay:true,
    controls:true,
    fluid:true
});

const loader = document.getElementById("loader");

player.on("playing",()=>loader.style.display="none");
player.on("waiting",()=>loader.style.display="flex");

function isFav(id){
    return favs.includes(id);
}

function toggleFav(id){
    if(isFav(id)){
        favs = favs.filter(x=>x!==id);
    }else{
        favs.push(id);
    }
    localStorage.setItem("favs",JSON.stringify(favs));
    render(channels);
}

function play(ch){
    loader.style.display="flex";
    player.src({src:ch.url,type:"application/x-mpegURL"});
    player.play();
}

function render(list){
    const box=document.getElementById("channelList");
    box.innerHTML="";
    list.forEach(ch=>{
        const div=document.createElement("div");
        div.className="channel";
        div.innerHTML=`
            ${ch.logo
            ? `<img src="${ch.logo}" onerror="this.style.display='none';this.nextElementSibling.style.display='block'">`
            : ``}
            <i class="fa fa-tv logo-fallback" style="display:${ch.logo?'none':'block'}"></i>
            <span>${ch.name}</span>
            <i class="fa fa-star star ${isFav(ch.id)?'active':''}"></i>
        `;
        div.onclick=()=>play(ch);
        div.querySelector(".star").onclick=(e)=>{
            e.stopPropagation();
            toggleFav(ch.id);
        };
        box.appendChild(div);
    });
}

function showFav(){
    render(channels.filter(c=>isFav(c.id)));
}

function showAll(){
    render(channels);
}

render(channels);
play(channels[0]);
</script>

</body>
</html>
